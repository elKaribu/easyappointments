/* ----------------------------------------------------------------------------
 * Easy!Appointments - Open Source Web Scheduler
 *
 * @package     EasyAppointments
 * @author      A.Tselegidis <alextselegidis@gmail.com>
 * @copyright   Copyright (c) 2013 - 2020, Alex Tselegidis
 * @license     http://opensource.org/licenses/GPL-3.0 - GPLv3
 * @link        http://easyappointments.org
 * @since       v1.0.0
 * ---------------------------------------------------------------------------- */
!function(){"use strict";var e=function(){};e.prototype.save=function(e){var a=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_settings",t={csrfToken:GlobalVariables.csrfToken,settings:JSON.stringify(e),type:BackendSettings.SETTINGS_SYSTEM};$.post(a,t).done((function(){Backend.displayNotification(EALang.settings_saved),$("#header-logo span").text($("#company-name").val());var e=$("#book-advance-timeout").val(),a=Math.floor(e/60),t=e%60;$("#book-advance-timeout-helper").text(EALang.book_advance_timeout_hint.replace("{$limit}",("0"+a).slice(-2)+":"+("0"+t).slice(-2))),GlobalVariables.timeFormat=$("#time-format").val(),GlobalVariables.firstWeekday=$("#first-weekday").val();var n=BackendSettings.wp.get();BackendSettings.wp.setup(n),BackendSettings.wp.timepickers(!1);var i=BackendSettings.wi.get();BackendSettings.wi.setup(i)}))},e.prototype.get=function(){var e=[];return $("#general").find("input, select").not("input:checkbox").each((function(a,t){e.push({name:$(t).attr("data-field"),value:$(t).val()})})),e.push({name:"customer_notifications",value:$("#customer-notifications").prop("checked")?"1":"0"}),e.push({name:"provider_notifications",value:$("#provider-notifications").prop("checked")?"1":"0"}),e.push({name:"secretary_notifications",value:$("#secretary-notifications").prop("checked")?"1":"0"}),e.push({name:"admin_notifications",value:$("#admin-notifications").prop("checked")?"1":"0"}),e.push({name:"require_captcha",value:$("#require-captcha").prop("checked")?"1":"0"}),e.push({name:"require_phone_number",value:$("#require-phone-number").prop("checked")?"1":"0"}),e.push({name:"display_any_provider",value:$("#display-any-provider").prop("checked")?"1":"0"}),$("#website").find("input, select").not("input:checkbox, input:radio, .website-image-url").each((function(a,t){e.push({name:$(t).attr("data-field"),value:$(t).val()})})),e.push({name:"theme_color",value:$("input:radio[name='theme-color']:checked").val()}),e.push({name:"font_family",value:$("input:radio[name='font-family']:checked").val()}),e.push({name:"website_images",value:JSON.stringify(BackendSettings.wi.get())}),e.push({name:"company_working_plan",value:JSON.stringify(BackendSettings.wp.get())}),e.push({name:"book_advance_timeout",value:$("#book-advance-timeout").val()}),e.push({name:"display_cookie_notice",value:$("#display-cookie-notice").prop("checked")?"1":"0"}),e.push({name:"cookie_notice_content",value:$("#cookie-notice-content").trumbowyg("html")}),e.push({name:"display_terms_and_conditions",value:$("#display-terms-and-conditions").prop("checked")?"1":"0"}),e.push({name:"terms_and_conditions_content",value:$("#terms-and-conditions-content").trumbowyg("html")}),e.push({name:"display_privacy_policy",value:$("#display-privacy-policy").prop("checked")?"1":"0"}),e.push({name:"privacy_policy_content",value:$("#privacy-policy-content").trumbowyg("html")}),e},e.prototype.validate=function(){$("#general .has-error").removeClass("has-error");try{var e=!1;if($("#general .required").each((function(a,t){$(t).val()||($(t).closest(".form-group").addClass("has-error"),e=!0)})),e)throw new Error(EALang.fields_are_required);if(!GeneralFunctions.validateEmail($("#company-email").val()))throw $("#company-email").closest(".form-group").addClass("has-error"),new Error(EALang.invalid_email);return!0}catch(e){return Backend.displayNotification(e.message),!1}},window.SystemSettings=e}();
