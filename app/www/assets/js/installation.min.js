/* ----------------------------------------------------------------------------
 * Easy!Appointments - Open Source Web Scheduler
 *
 * @package     EasyAppointments
 * @author      A.Tselegidis <alextselegidis@gmail.com>
 * @copyright   Copyright (c) 2013 - 2020, Alex Tselegidis
 * @license     http://opensource.org/licenses/GPL-3.0 - GPLv3
 * @link        http://easyappointments.org
 * @since       v1.0.0
 * ---------------------------------------------------------------------------- */
$((function(){"use strict";var a=$("#install"),e=$(".alert");$(document).ajaxStart((function(){$("#loading").removeClass("d-none")})),$(document).ajaxStop((function(){$("#loading").addClass("d-none")})),a.on("click",(function(){if(function(){try{e.removeClass("alert-danger").addClass("hidden"),$("input").closest(".form-group").removeClass("has-error");var a=!1;if($("input").each((function(e,s){$(s).val()||($(s).closest(".form-group").addClass("has-error"),a=!0)})),a)throw new Error("All the page fields are required.");if($("#password").val()!==$("#retype-password").val())throw $("#password").closest(".form-group").addClass("has-error"),$("#retype-password").closest(".form-group").addClass("has-error"),new Error("Passwords do not match!");if($("#password").val().length<7)throw $("#password").closest(".form-group").addClass("has-error"),$("#retype-password").closest(".form-group").addClass("has-error"),new Error("The password must be at least 7 characters long.");if(!GeneralFunctions.validateEmail($("#email").val()))throw $("#email").closest(".form-group").addClass("has-error"),new Error("The email address is invalid!");if(!GeneralFunctions.validateEmail($("#company-email").val()))throw $("#company-email").closest(".form-group").addClass("has-error"),new Error("The email address is invalid!");return!0}catch(a){return e.addClass("alert-danger").text(a.message).removeClass("hidden"),!1}}()){var a=GlobalVariables.baseUrl+"/index.php/installation/ajax_install",s={csrfToken:GlobalVariables.csrfToken,admin:{first_name:$("#first-name").val(),last_name:$("#last-name").val(),email:$("#email").val(),phone_number:$("#phone-number").val(),username:$("#username").val(),password:$("#password").val(),address:$("#address").val(),city:$("#city").val(),zip_code:$("#zip-code").val()},company:{company_name:$("#company-name").val(),company_email:$("#company-email").val(),company_link:$("#company-link").val()},webpage:{website_title:$("#website-title").val(),website_description:$("#website-description").val(),website_logo:$("#website-logo").val(),website_images:"{}",theme_color:$('input:radio[name="theme-color"]:checked').val()}};$.ajax({url:a,type:"POST",data:s,dataType:"json"}).done((function(a){e.text("Easy!Appointments has been successfully installed!").addClass("alert-success").removeClass("hidden"),setTimeout((function(){window.location.href=GlobalVariables.baseUrl+"/index.php/backend"}),1e3)}))}})),"/"===GlobalVariables.baseUrl.slice(-1)&&(GeneralFunctions.displayMessageBox("Misconfiguration Detected","Please remove any trailing slashes from your BASE_URL setting of the root config.php file and try again."),a.prop("disabled",!0).fadeTo("0.4"))}));
